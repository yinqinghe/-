import scrapy
from scrapy import Request
from scrapy.selector import Selector

class BaidutiebapicsSpider(scrapy.Spider):
    name = 'baiduTiebaPics'
    allowed_domains = ['tieba.baidu.com/']
    start_urls = ['https://tieba.baidu.com//']
    header={
        # 'cookie':'BIDUPSID=8F10C06B4F3326FE2876D959A11FB138; PSTM=1602322183; __yjs_duid=1_905405d7cc47199ebc65346ca416028b1617943503562; BDUSS=F3MjA1cXdWR1BweVBTa0tsdDhEd0pUTzVoSDlTd1BvMnlTZllQflFWZ2RWb3RoRVFBQUFBJCQAAAAAAQAAAAEAAABsYCsey97J4cnPv87Jz7~OAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB3JY2EdyWNhMW; BDUSS_BFESS=F3MjA1cXdWR1BweVBTa0tsdDhEd0pUTzVoSDlTd1BvMnlTZllQflFWZ2RWb3RoRVFBQUFBJCQAAAAAAQAAAAEAAABsYCsey97J4cnPv87Jz7~OAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB3JY2EdyWNhMW; wise_device=0; st_key_id=17; H_WISE_SIDS=110085_127969_132549_176399_179346_184716_188743_189755_190616_191254_194085_194511_194519_194530_195343_196426_197241_197711_197958_199568_200993_201193_201541_201701_202651_203190_203309_203520_204254_204305_204536_204778_204864_204917_205217_205234_205548_205569_206008_206122_206144_206249_206516_206681_206767_206905_207021_207177_207265_207364_207389_207471_207498_207610_207626_207716_207863_208001_208045_208055_208114_208163_208165_208225_208267_208271_208309_208312_208363_208559_208599_208721_208770_208772_208776_209140_209148_209294; STOKEN=869ef4bbe00b9c6fe53fee1d95e24ef6c034a2bfe8b673a90e892a19a4106d0f; Hm_lvt_98b9d8c2fd6608d564bf2ac2ae642948=1649209292; USER_JUMP=-1; Hm_lvt_287705c8d9e2073d13275b18dbd746dc=1649209292; BDSFRCVID=G7-OJexroG0xFB3D_Hm8uRtLxzTnskcTDYrEOwXPsp3LGJLVguQPEG0PttE_sDu-ox3logKKymOTHukF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF=tRk8oCPbtDvDqTrP-trf5DCShUFsKq3dB2Q-XPoO3KJWsl_RQhn1LnI00lOrhnTnaj7W3Mbgy4op8P3y0bb2DUA1y4vpKbQILgTxoUJ2bp5rqpbGqtnWDPAebPRih4r9QgbtBhQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0hD0wDjA5D6PO5pCX5-CsWIJT2hcHMPoosIJ9QxK5Qh4nLp6tQJ3rMgc-KfTRJfbUotoH-JCV5l-bbfAe5qOp55TIbp5TtUJMsJbyMpQTqt4bDUvyKMniMCj9-pna2hQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuDjtBDjvyDGRabK6aKC5bL6rJabC3HqOJXU6q2bDeQN3O0fDe3NO7_DJaLtbdJ-c2hRbO-p0vWq54WbbvLT7johRTWqR4eP5h0MonDh835-odbM3tHCOOobRO5hvvJJ6O3M7hMUKmDloOW-TB5bbPLUQF5l8-sq0x0bOte-bQXH_EJ6-8tR-eoDvt-5rDHJTg5DTjhPrMQNtLWMT-MTryKKJy3q_5sM7Shj7h0R0T2h6n2JJWKanRh4oNB-3iV-OxDUvnyxAZbpoIQUQxtNRJLp57-hbhKJ79DPvobUPU2fc9LUvt22cdot5yBbc8eIna5hjkbfJBQttjQn3hfIkj2CKLtC0BhDPRD6RDKICV-frb-C62aKDsKK0EBhcqJ-ovQT3WQxjyQbn726vtLjnrXPcmatOOHUbeWJ5pXn-R0hbjJM7xWeJp0-5lLp5nhMJm5MorKU00qfnOJ-7y523iXR6vQpnhjpQ3DRoWXPIqbN7P-p5Z5mAqKl0MLPbtbb0xXj_0-nDSHH8jtj_e3s; BDSFRCVID_BFESS=G7-OJexroG0xFB3D_Hm8uRtLxzTnskcTDYrEOwXPsp3LGJLVguQPEG0PttE_sDu-ox3logKKymOTHukF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF_BFESS=tRk8oCPbtDvDqTrP-trf5DCShUFsKq3dB2Q-XPoO3KJWsl_RQhn1LnI00lOrhnTnaj7W3Mbgy4op8P3y0bb2DUA1y4vpKbQILgTxoUJ2bp5rqpbGqtnWDPAebPRih4r9QgbtBhQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0hD0wDjA5D6PO5pCX5-CsWIJT2hcHMPoosIJ9QxK5Qh4nLp6tQJ3rMgc-KfTRJfbUotoH-JCV5l-bbfAe5qOp55TIbp5TtUJMsJbyMpQTqt4bDUvyKMniMCj9-pna2hQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuDjtBDjvyDGRabK6aKC5bL6rJabC3HqOJXU6q2bDeQN3O0fDe3NO7_DJaLtbdJ-c2hRbO-p0vWq54WbbvLT7johRTWqR4eP5h0MonDh835-odbM3tHCOOobRO5hvvJJ6O3M7hMUKmDloOW-TB5bbPLUQF5l8-sq0x0bOte-bQXH_EJ6-8tR-eoDvt-5rDHJTg5DTjhPrMQNtLWMT-MTryKKJy3q_5sM7Shj7h0R0T2h6n2JJWKanRh4oNB-3iV-OxDUvnyxAZbpoIQUQxtNRJLp57-hbhKJ79DPvobUPU2fc9LUvt22cdot5yBbc8eIna5hjkbfJBQttjQn3hfIkj2CKLtC0BhDPRD6RDKICV-frb-C62aKDsKK0EBhcqJ-ovQT3WQxjyQbn726vtLjnrXPcmatOOHUbeWJ5pXn-R0hbjJM7xWeJp0-5lLp5nhMJm5MorKU00qfnOJ-7y523iXR6vQpnhjpQ3DRoWXPIqbN7P-p5Z5mAqKl0MLPbtbb0xXj_0-nDSHH8jtj_e3s; delPer=0; PSINO=1; BDRCVFR[n9IS1zhFc9f]=mk3SLVN4HKm; BDORZ=FFFB88E999055A3F8A630C64834BD6D0; ZD_ENTRY=google; BAIDUID=D84211676C899F732CD158D80EA5DA46:FG=1; H_PS_PSSID=31253_26350; BAIDUID_BFESS=7EC2BF8BBEE5880096BD3BF9D8B84841:FG=1; showCardBeforeSign=1; 4801126508_FRSVideoUploadTip=1; video_bubble4801126508=1; BAIDU_WISE_UID=wapp_1649985667109_710; Hm_lpvt_287705c8d9e2073d13275b18dbd746dc=1649986237; tb_as_data=c3544102dacb6c52f509a88745497e55ee3a14b0d70d60c656ef845e849c5b13d8232655d1fa694c08d1d6ed9e2e63b0d9c5caa913b8c3440acc81ebd38b085f35d18464e16cb2c3d1c233e9534897df063d692c18fcb55a8a752c47e26cbcb2; Hm_lpvt_98b9d8c2fd6608d564bf2ac2ae642948=1649997137; ab_sr=1.0.1_YmNiZjA2YmZiZmExYzBmZmFlNzg4MDU1NGUwYzdjZmI4MDkxMjk4YzcxNzI0NTg2NTFiM2NjMzNjMjJhMzYwZjA2NDAzMjMwZjllM2FkMGMzYzk0NTE0NTg3YjNlNmQ0N2Y4MzFkYWI2MWQ4ZWU0MGEwM2I2NGZmNzk0YWVmYjhiMTA4OTMwY2U4ZjY3ZmUyNGJiNDM3ZWVlYzkzOGYzZGM3N2U1NGZmN2ZjY2IyMDA5NzM5MTg3ZmFjNzU3YjFm; st_data=75db67bd8ea82d14e82b62f967ec927c818dcc4aa6fa776eec207f059c97524323cf65d133e99a0ed9a4bc8f8e78932673ea11c4ddf97d0fa35358a33bec199ab52cb122d219d6cda78c9a77c8d8e9edd5597f1112ae540f6b50b4e59a6eb621; st_sign=c7363493',
        'cookie':'BIDUPSID=8F10C06B4F3326FE2876D959A11FB138; PSTM=1602322183; __yjs_duid=1_905405d7cc47199ebc65346ca416028b1617943503562; BDUSS=F3MjA1cXdWR1BweVBTa0tsdDhEd0pUTzVoSDlTd1BvMnlTZllQflFWZ2RWb3RoRVFBQUFBJCQAAAAAAQAAAAEAAABsYCsey97J4cnPv87Jz7~OAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB3JY2EdyWNhMW; BDUSS_BFESS=F3MjA1cXdWR1BweVBTa0tsdDhEd0pUTzVoSDlTd1BvMnlTZllQflFWZ2RWb3RoRVFBQUFBJCQAAAAAAQAAAAEAAABsYCsey97J4cnPv87Jz7~OAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB3JY2EdyWNhMW; wise_device=0; st_key_id=17; H_WISE_SIDS=110085_127969_132549_176399_179346_184716_188743_189755_190616_191254_194085_194511_194519_194530_195343_196426_197241_197711_197958_199568_200993_201193_201541_201701_202651_203190_203309_203520_204254_204305_204536_204778_204864_204917_205217_205234_205548_205569_206008_206122_206144_206249_206516_206681_206767_206905_207021_207177_207265_207364_207389_207471_207498_207610_207626_207716_207863_208001_208045_208055_208114_208163_208165_208225_208267_208271_208309_208312_208363_208559_208599_208721_208770_208772_208776_209140_209148_209294; STOKEN=869ef4bbe00b9c6fe53fee1d95e24ef6c034a2bfe8b673a90e892a19a4106d0f; Hm_lvt_98b9d8c2fd6608d564bf2ac2ae642948=1649209292; USER_JUMP=-1; Hm_lvt_287705c8d9e2073d13275b18dbd746dc=1649209292; BDSFRCVID=G7-OJexroG0xFB3D_Hm8uRtLxzTnskcTDYrEOwXPsp3LGJLVguQPEG0PttE_sDu-ox3logKKymOTHukF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF=tRk8oCPbtDvDqTrP-trf5DCShUFsKq3dB2Q-XPoO3KJWsl_RQhn1LnI00lOrhnTnaj7W3Mbgy4op8P3y0bb2DUA1y4vpKbQILgTxoUJ2bp5rqpbGqtnWDPAebPRih4r9QgbtBhQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0hD0wDjA5D6PO5pCX5-CsWIJT2hcHMPoosIJ9QxK5Qh4nLp6tQJ3rMgc-KfTRJfbUotoH-JCV5l-bbfAe5qOp55TIbp5TtUJMsJbyMpQTqt4bDUvyKMniMCj9-pna2hQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuDjtBDjvyDGRabK6aKC5bL6rJabC3HqOJXU6q2bDeQN3O0fDe3NO7_DJaLtbdJ-c2hRbO-p0vWq54WbbvLT7johRTWqR4eP5h0MonDh835-odbM3tHCOOobRO5hvvJJ6O3M7hMUKmDloOW-TB5bbPLUQF5l8-sq0x0bOte-bQXH_EJ6-8tR-eoDvt-5rDHJTg5DTjhPrMQNtLWMT-MTryKKJy3q_5sM7Shj7h0R0T2h6n2JJWKanRh4oNB-3iV-OxDUvnyxAZbpoIQUQxtNRJLp57-hbhKJ79DPvobUPU2fc9LUvt22cdot5yBbc8eIna5hjkbfJBQttjQn3hfIkj2CKLtC0BhDPRD6RDKICV-frb-C62aKDsKK0EBhcqJ-ovQT3WQxjyQbn726vtLjnrXPcmatOOHUbeWJ5pXn-R0hbjJM7xWeJp0-5lLp5nhMJm5MorKU00qfnOJ-7y523iXR6vQpnhjpQ3DRoWXPIqbN7P-p5Z5mAqKl0MLPbtbb0xXj_0-nDSHH8jtj_e3s; BDSFRCVID_BFESS=G7-OJexroG0xFB3D_Hm8uRtLxzTnskcTDYrEOwXPsp3LGJLVguQPEG0PttE_sDu-ox3logKKymOTHukF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF_BFESS=tRk8oCPbtDvDqTrP-trf5DCShUFsKq3dB2Q-XPoO3KJWsl_RQhn1LnI00lOrhnTnaj7W3Mbgy4op8P3y0bb2DUA1y4vpKbQILgTxoUJ2bp5rqpbGqtnWDPAebPRih4r9QgbtBhQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0hD0wDjA5D6PO5pCX5-CsWIJT2hcHMPoosIJ9QxK5Qh4nLp6tQJ3rMgc-KfTRJfbUotoH-JCV5l-bbfAe5qOp55TIbp5TtUJMsJbyMpQTqt4bDUvyKMniMCj9-pna2hQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuDjtBDjvyDGRabK6aKC5bL6rJabC3HqOJXU6q2bDeQN3O0fDe3NO7_DJaLtbdJ-c2hRbO-p0vWq54WbbvLT7johRTWqR4eP5h0MonDh835-odbM3tHCOOobRO5hvvJJ6O3M7hMUKmDloOW-TB5bbPLUQF5l8-sq0x0bOte-bQXH_EJ6-8tR-eoDvt-5rDHJTg5DTjhPrMQNtLWMT-MTryKKJy3q_5sM7Shj7h0R0T2h6n2JJWKanRh4oNB-3iV-OxDUvnyxAZbpoIQUQxtNRJLp57-hbhKJ79DPvobUPU2fc9LUvt22cdot5yBbc8eIna5hjkbfJBQttjQn3hfIkj2CKLtC0BhDPRD6RDKICV-frb-C62aKDsKK0EBhcqJ-ovQT3WQxjyQbn726vtLjnrXPcmatOOHUbeWJ5pXn-R0hbjJM7xWeJp0-5lLp5nhMJm5MorKU00qfnOJ-7y523iXR6vQpnhjpQ3DRoWXPIqbN7P-p5Z5mAqKl0MLPbtbb0xXj_0-nDSHH8jtj_e3s; BDORZ=FFFB88E999055A3F8A630C64834BD6D0; BAIDUID=D84211676C899F732CD158D80EA5DA46:FG=1; H_PS_PSSID=31253_26350; showCardBeforeSign=1; 4801126508_FRSVideoUploadTip=1; video_bubble4801126508=1; delPer=0; PSINO=1; BAIDUID_BFESS=85FF07342EE8F5F981377AD5D1BA61EE:FG=1; tb_as_data=c3544102dacb6c52f509a88745497e55ee3a14b0d70d60c656ef845e849c5b13d8232655d1fa694c08d1d6ed9e2e63b0a0ddf9786626f71fa13cdd7f93dca4a517afde132888028dc6c2a2684ec7c19ef0118eb83cfc0ba51880531ee4dc4c76; Hm_lpvt_98b9d8c2fd6608d564bf2ac2ae642948=1650009059; Hm_lpvt_287705c8d9e2073d13275b18dbd746dc=1650009060; ab_sr=1.0.1_YzBkOWFkZWExZDk0NTI4MWU1NDk5YjA3ZDA2NzQ0NDI1MWFiMmUzNGYyODE3NmE1YmNjMzRhMGM1MTk2NmUzODA5ZGIzZmU3OWNlNDc2YzJjYTE5ZTEyOTBlOThkYjVkZDI4OTliYjA0YmYwODczMTU0OTEwMDYyNDI4ODhlNzA0MmViMzQ2OGFlZTBkNzljM2MwYjQ3NDEyMDc5ZWQ5ZmU5ZDVjYTJlNzM3MmY5ZDBiZmQ3NWFlODNkZWQ0YjUw; st_data=75db67bd8ea82d14e82b62f967ec927c818dcc4aa6fa776eec207f059c97524323cf65d133e99a0ed9a4bc8f8e78932673ea11c4ddf97d0fa35358a33bec199ae32c79762fd83d1594f49c715e995432145326ed22fd74683c925d3f4bdf9916; st_sign=b24fad5e',
    }

    def start_requests(self):

        url='https://tieba.baidu.com/p/7802268997'
        yield self.make_requests_from_url(url)

    def make_requests_from_url(self, url):
        return Request(url,dont_filter=True,callback=self.parse,headers=self.header)
    def parse(self, response):
        selector=Selector(response=response)
        # print(response.text)
        img_link=selector.xpath('//img[@class="BDE_Image"]').xpath('./@src')

        title=selector.xpath('/html/head/title/text()').get()
        print(title)
        print(img_link.getall())
        print(len(img_link))
        pass
